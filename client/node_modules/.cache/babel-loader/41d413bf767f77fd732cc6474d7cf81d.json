{"ast":null,"code":"import _objectSpread from \"D:\\\\Projects\\\\udemy-react-projects\\\\Crwn-clothing\\\\crwn-clothing\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport { takeLatest, put, all, call } from 'redux-saga/effects';\nimport userTypes from './user.types';\nimport { googleProvider, auth, createUserProfileDocument, getCurrentUser } from '../../firebase/firebase.utils';\nimport { signInFailure, signInSuccess, signOutFailure, signOutSuccess, signUpFailure, signUpSuccess } from './user.actions';\nexport function* getAuthUserSnapshot(user, additionalData) {\n  try {\n    const userRef = yield call(createUserProfileDocument, user, additionalData);\n    const snapshot = yield userRef.get();\n    yield put(signInSuccess(_objectSpread({\n      id: snapshot.id\n    }, snapshot.data())));\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n}\nexport function* onGoogleSignIn() {\n  try {\n    const _ref = yield auth.signInWithPopup(googleProvider),\n          user = _ref.user;\n\n    yield getAuthUserSnapshot(user);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n}\nexport function* onEmailSignIn({\n  payload: {\n    email,\n    password\n  }\n}) {\n  try {\n    const _ref2 = yield auth.signInWithEmailAndPassword(email, password),\n          user = _ref2.user;\n\n    yield getAuthUserSnapshot(user);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n}\nexport function* isUserAuthenticated() {\n  try {\n    const userAuth = yield getCurrentUser();\n    if (!userAuth) return;\n    yield getAuthUserSnapshot(userAuth);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n}\nexport function* onUserSignOut() {\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  } catch (error) {\n    yield put(signOutFailure(error.message));\n  }\n}\nexport function* onSignUpUser(action) {\n  const _action$payload = action.payload,\n        email = _action$payload.email,\n        password = _action$payload.password,\n        displayName = _action$payload.displayName;\n\n  try {\n    const _ref3 = yield auth.createUserWithEmailAndPassword(email, password),\n          user = _ref3.user;\n\n    yield put(signUpSuccess({\n      user,\n      additionalData: {\n        displayName\n      }\n    }));\n    yield getAuthUserSnapshot(user, {\n      displayName\n    });\n  } catch (error) {\n    yield put(signUpFailure(error.message));\n  }\n}\nexport function* googleSignInStart() {\n  yield takeLatest(userTypes.GOOGLE_SIGN_IN_START, onGoogleSignIn);\n}\nexport function* emailSignInStart() {\n  yield takeLatest(userTypes.EMAIL_SIGN_IN_START, onEmailSignIn);\n}\nexport function* checkUserSession() {\n  yield takeLatest(userTypes.CHECK_USER_SESSION, isUserAuthenticated);\n}\nexport function* signOutUserStart() {\n  yield takeLatest(userTypes.SIGN_OUT_START, onUserSignOut);\n}\nexport function* signUpStart() {\n  yield takeLatest(userTypes.SIGN_UP_START, onSignUpUser);\n}\nexport function* userSagas() {\n  yield all([call(googleSignInStart), call(emailSignInStart), call(checkUserSession), call(signOutUserStart), call(signUpStart)]);\n}","map":{"version":3,"sources":["D:\\Projects\\udemy-react-projects\\Crwn-clothing\\crwn-clothing\\client\\src\\redux\\user\\user-sagas.js"],"names":["takeLatest","put","all","call","userTypes","googleProvider","auth","createUserProfileDocument","getCurrentUser","signInFailure","signInSuccess","signOutFailure","signOutSuccess","signUpFailure","signUpSuccess","getAuthUserSnapshot","user","additionalData","userRef","snapshot","get","id","data","error","message","onGoogleSignIn","signInWithPopup","onEmailSignIn","payload","email","password","signInWithEmailAndPassword","isUserAuthenticated","userAuth","onUserSignOut","signOut","onSignUpUser","action","displayName","createUserWithEmailAndPassword","googleSignInStart","GOOGLE_SIGN_IN_START","emailSignInStart","EMAIL_SIGN_IN_START","checkUserSession","CHECK_USER_SESSION","signOutUserStart","SIGN_OUT_START","signUpStart","SIGN_UP_START","userSagas"],"mappings":"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","sourcesContent":["import {takeLatest, put, all, call} from 'redux-saga/effects';\r\n\r\nimport userTypes from './user.types';\r\nimport {googleProvider, auth, createUserProfileDocument, getCurrentUser} from '../../firebase/firebase.utils';\r\nimport {signInFailure, signInSuccess, signOutFailure, signOutSuccess, signUpFailure, signUpSuccess} from './user.actions';\r\n\r\nexport function* getAuthUserSnapshot(user, additionalData) {\r\n  try {\r\n    const userRef = yield call(createUserProfileDocument, user, additionalData);\r\n    const snapshot = yield userRef.get();\r\n    yield put(signInSuccess({id: snapshot.id, ...snapshot.data()}))\r\n  } catch(error) {\r\n    yield put(signInFailure(error.message));\r\n  }\r\n}\r\n\r\nexport function* onGoogleSignIn() {\r\n  try {\r\n    const {user} = yield auth.signInWithPopup(googleProvider);\r\n    yield getAuthUserSnapshot(user);\r\n  } catch(error) {\r\n    yield put(signInFailure(error.message));\r\n  }\r\n}\r\n\r\nexport function* onEmailSignIn({payload: {email, password}}) {\r\n  try {\r\n    const {user} = yield auth.signInWithEmailAndPassword(email, password);\r\n    yield getAuthUserSnapshot(user);\r\n  } catch(error) {\r\n    yield put(signInFailure(error.message))\r\n  }\r\n}\r\n\r\nexport function* isUserAuthenticated() {\r\n  try {\r\n    const userAuth = yield getCurrentUser();\r\n    if(!userAuth) return;\r\n    yield getAuthUserSnapshot(userAuth);\r\n  } catch(error) {\r\n    yield put(signInFailure(error.message));\r\n  }\r\n}\r\n\r\nexport function* onUserSignOut() {\r\n  try {\r\n    yield auth.signOut();\r\n    yield put(signOutSuccess());\r\n  }catch(error) {\r\n    yield put(signOutFailure(error.message));\r\n  }\r\n}\r\n\r\nexport function* onSignUpUser(action) {\r\n  const {email, password, displayName} = action.payload;\r\n  try{\r\n    const {user} = yield auth.createUserWithEmailAndPassword(email, password);\r\n    yield put(signUpSuccess({user, additionalData: {displayName}}));\r\n\r\n    yield getAuthUserSnapshot(user, {displayName});\r\n\r\n  } catch(error) {\r\n    yield put(signUpFailure(error.message));\r\n  }\r\n}\r\n\r\nexport function* googleSignInStart() {\r\n  yield takeLatest(userTypes.GOOGLE_SIGN_IN_START, onGoogleSignIn);\r\n}\r\n\r\nexport function* emailSignInStart() {\r\n  yield takeLatest(userTypes.EMAIL_SIGN_IN_START, onEmailSignIn);\r\n}\r\n\r\nexport function* checkUserSession() {\r\n  yield takeLatest(userTypes.CHECK_USER_SESSION, isUserAuthenticated);\r\n}\r\n\r\nexport function* signOutUserStart() {\r\n  yield takeLatest(userTypes.SIGN_OUT_START, onUserSignOut)\r\n}\r\n\r\nexport function* signUpStart() {\r\n  yield takeLatest(userTypes.SIGN_UP_START, onSignUpUser);\r\n}\r\n\r\nexport function* userSagas() {\r\n  yield all([\r\n    call(googleSignInStart),\r\n    call(emailSignInStart),\r\n    call(checkUserSession),\r\n    call(signOutUserStart),\r\n    call(signUpStart)\r\n  ])\r\n}\r\n"]},"metadata":{},"sourceType":"module"}